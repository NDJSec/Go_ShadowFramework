package winrevshell

import (
	"fmt"
	"strings"

	"github.com/NDJSec/Go_ShadowFramework/utils"
)

var lhost string

func WinRevShellHandler(UserInput string) {
	input := strings.ToLower(UserInput)
	if strings.Contains(input, "show options") {
		fmt.Println("Module Options (exploit/Win_Rev_Shell)")
		fmt.Println("Name 	Current Setting	Required	Description")
		fmt.Println("----    --------------- --------        -----------")
		fmt.Printf("LHOST  %s		        yes		Local host to be connected to\n", lhost)
	} else if strings.Contains(input, "set") {
		if strings.Contains(input, "lhost") {
			lhost = input[10:]
		}
	} else if strings.Contains(input, "run") {
		main()
	} else if strings.Contains(input, "back") {
		utils.SetRunVar("portscan", false)
	} else if strings.Contains(input, "help") {
		//Print help menu for this module
	}
}

func GetLhost() string {
	return lhost
}
